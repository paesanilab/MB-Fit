#include "poly-model.h"
    
namespace mb_system {

double poly_model::eval_direct(const double a[24], const double x[15], double g[15])
{
    double p[24];
    const double t0_0 = a[2]*(1);
    const double t0_1 = a[8]*(1*x[4] + 1*x[5] + 1*x[3] + 1*x[6]);
    const double t0_2 = a[11]*(2*x[0]);
    const double t0_3 = a[14]*(1*x[7] + 1*x[2] + 1*x[1] + 1*x[8]);
    const double t0_4 = a[20]*(1*x[12] + 1*x[11] + 1*x[10] + 1*x[13]);
    const double t0_5 = a[21]*(1*x[14] + 1*x[9]);
    g[0] = t0_0 + t0_1 + t0_2 + t0_3 + t0_4 + t0_5;
    const double t1_0 = a[3]*(1*x[13] + 1*x[12]);
    const double t1_1 = a[4]*(1*x[11] + 1*x[10]);
    const double t1_2 = a[5]*(1*x[5]);
    const double t1_3 = a[14]*(1*x[0]);
    const double t1_4 = a[16]*(1*x[6]);
    const double t1_5 = a[18]*(1*x[3] + 1*x[4]);
    g[1] = t1_0 + t1_1 + t1_2 + t1_3 + t1_4 + t1_5;
    const double t2_0 = a[3]*(1*x[11] + 1*x[10]);
    const double t2_1 = a[4]*(1*x[13] + 1*x[12]);
    const double t2_2 = a[5]*(1*x[6]);
    const double t2_3 = a[14]*(1*x[0]);
    const double t2_4 = a[16]*(1*x[5]);
    const double t2_5 = a[18]*(1*x[3] + 1*x[4]);
    g[2] = t2_0 + t2_1 + t2_2 + t2_3 + t2_4 + t2_5;
    const double t3_0 = a[1]*(1);
    const double t3_1 = a[5]*(1*x[7]);
    const double t3_2 = a[7]*(1*x[14]);
    const double t3_3 = a[8]*(1*x[0]);
    const double t3_4 = a[9]*(1*x[9]);
    const double t3_5 = a[12]*(1*x[11] + 1*x[13]);
    const double t3_6 = a[15]*(2*x[3]);
    const double t3_7 = a[16]*(1*x[8]);
    const double t3_8 = a[18]*(1*x[1] + 1*x[2]);
    const double t3_9 = a[19]*(1*x[4]);
    const double t3_10 = a[22]*(1*x[5] + 1*x[6]);
    const double t3_11 = a[23]*(1*x[12] + 1*x[10]);
    g[3] = t3_0 + t3_1 + t3_2 + t3_3 + t3_4 + t3_5 + t3_6 + t3_7 + t3_8 + t3_9 + t3_10 + t3_11;
    const double t4_0 = a[1]*(1);
    const double t4_1 = a[5]*(1*x[8]);
    const double t4_2 = a[7]*(1*x[14]);
    const double t4_3 = a[8]*(1*x[0]);
    const double t4_4 = a[9]*(1*x[9]);
    const double t4_5 = a[12]*(1*x[12] + 1*x[10]);
    const double t4_6 = a[15]*(2*x[4]);
    const double t4_7 = a[16]*(1*x[7]);
    const double t4_8 = a[18]*(1*x[2] + 1*x[1]);
    const double t4_9 = a[19]*(1*x[3]);
    const double t4_10 = a[22]*(1*x[5] + 1*x[6]);
    const double t4_11 = a[23]*(1*x[11] + 1*x[13]);
    g[4] = t4_0 + t4_1 + t4_2 + t4_3 + t4_4 + t4_5 + t4_6 + t4_7 + t4_8 + t4_9 + t4_10 + t4_11;
    const double t5_0 = a[1]*(1);
    const double t5_1 = a[5]*(1*x[1]);
    const double t5_2 = a[7]*(1*x[9]);
    const double t5_3 = a[8]*(1*x[0]);
    const double t5_4 = a[9]*(1*x[14]);
    const double t5_5 = a[12]*(1*x[13] + 1*x[12]);
    const double t5_6 = a[15]*(2*x[5]);
    const double t5_7 = a[16]*(1*x[2]);
    const double t5_8 = a[18]*(1*x[8] + 1*x[7]);
    const double t5_9 = a[19]*(1*x[6]);
    const double t5_10 = a[22]*(1*x[4] + 1*x[3]);
    const double t5_11 = a[23]*(1*x[11] + 1*x[10]);
    g[5] = t5_0 + t5_1 + t5_2 + t5_3 + t5_4 + t5_5 + t5_6 + t5_7 + t5_8 + t5_9 + t5_10 + t5_11;
    const double t6_0 = a[1]*(1);
    const double t6_1 = a[5]*(1*x[2]);
    const double t6_2 = a[7]*(1*x[9]);
    const double t6_3 = a[8]*(1*x[0]);
    const double t6_4 = a[9]*(1*x[14]);
    const double t6_5 = a[12]*(1*x[11] + 1*x[10]);
    const double t6_6 = a[15]*(2*x[6]);
    const double t6_7 = a[16]*(1*x[1]);
    const double t6_8 = a[18]*(1*x[7] + 1*x[8]);
    const double t6_9 = a[19]*(1*x[5]);
    const double t6_10 = a[22]*(1*x[3] + 1*x[4]);
    const double t6_11 = a[23]*(1*x[12] + 1*x[13]);
    g[6] = t6_0 + t6_1 + t6_2 + t6_3 + t6_4 + t6_5 + t6_6 + t6_7 + t6_8 + t6_9 + t6_10 + t6_11;
    const double t7_0 = a[3]*(1*x[11] + 1*x[13]);
    const double t7_1 = a[4]*(1*x[12] + 1*x[10]);
    const double t7_2 = a[5]*(1*x[3]);
    const double t7_3 = a[14]*(1*x[0]);
    const double t7_4 = a[16]*(1*x[4]);
    const double t7_5 = a[18]*(1*x[5] + 1*x[6]);
    g[7] = t7_0 + t7_1 + t7_2 + t7_3 + t7_4 + t7_5;
    const double t8_0 = a[3]*(1*x[10] + 1*x[12]);
    const double t8_1 = a[4]*(1*x[11] + 1*x[13]);
    const double t8_2 = a[5]*(1*x[4]);
    const double t8_3 = a[14]*(1*x[0]);
    const double t8_4 = a[16]*(1*x[3]);
    const double t8_5 = a[18]*(1*x[5] + 1*x[6]);
    g[8] = t8_0 + t8_1 + t8_2 + t8_3 + t8_4 + t8_5;
    const double t9_0 = a[6]*(1*x[12] + 1*x[11] + 1*x[10] + 1*x[13]);
    const double t9_1 = a[7]*(1*x[6] + 1*x[5]);
    const double t9_2 = a[9]*(1*x[3] + 1*x[4]);
    const double t9_3 = a[21]*(1*x[0]);
    g[9] = t9_0 + t9_1 + t9_2 + t9_3;
    const double t10_0 = a[0]*(1);
    const double t10_1 = a[3]*(1*x[2] + 1*x[8]);
    const double t10_2 = a[4]*(1*x[1] + 1*x[7]);
    const double t10_3 = a[6]*(1*x[9] + 1*x[14]);
    const double t10_4 = a[10]*(1*x[11] + 1*x[12]);
    const double t10_5 = a[12]*(1*x[4] + 1*x[6]);
    const double t10_6 = a[13]*(2*x[10]);
    const double t10_7 = a[17]*(1*x[13]);
    const double t10_8 = a[20]*(1*x[0]);
    const double t10_9 = a[23]*(1*x[5] + 1*x[3]);
    g[10] = t10_0 + t10_1 + t10_2 + t10_3 + t10_4 + t10_5 + t10_6 + t10_7 + t10_8 + t10_9;
    const double t11_0 = a[0]*(1);
    const double t11_1 = a[3]*(1*x[7] + 1*x[2]);
    const double t11_2 = a[4]*(1*x[1] + 1*x[8]);
    const double t11_3 = a[6]*(1*x[14] + 1*x[9]);
    const double t11_4 = a[10]*(1*x[10] + 1*x[13]);
    const double t11_5 = a[12]*(1*x[3] + 1*x[6]);
    const double t11_6 = a[13]*(2*x[11]);
    const double t11_7 = a[17]*(1*x[12]);
    const double t11_8 = a[20]*(1*x[0]);
    const double t11_9 = a[23]*(1*x[4] + 1*x[5]);
    g[11] = t11_0 + t11_1 + t11_2 + t11_3 + t11_4 + t11_5 + t11_6 + t11_7 + t11_8 + t11_9;
    const double t12_0 = a[0]*(1);
    const double t12_1 = a[3]*(1*x[8] + 1*x[1]);
    const double t12_2 = a[4]*(1*x[7] + 1*x[2]);
    const double t12_3 = a[6]*(1*x[9] + 1*x[14]);
    const double t12_4 = a[10]*(1*x[13] + 1*x[10]);
    const double t12_5 = a[12]*(1*x[4] + 1*x[5]);
    const double t12_6 = a[13]*(2*x[12]);
    const double t12_7 = a[17]*(1*x[11]);
    const double t12_8 = a[20]*(1*x[0]);
    const double t12_9 = a[23]*(1*x[3] + 1*x[6]);
    g[12] = t12_0 + t12_1 + t12_2 + t12_3 + t12_4 + t12_5 + t12_6 + t12_7 + t12_8 + t12_9;
    const double t13_0 = a[0]*(1);
    const double t13_1 = a[3]*(1*x[1] + 1*x[7]);
    const double t13_2 = a[4]*(1*x[2] + 1*x[8]);
    const double t13_3 = a[6]*(1*x[14] + 1*x[9]);
    const double t13_4 = a[10]*(1*x[12] + 1*x[11]);
    const double t13_5 = a[12]*(1*x[5] + 1*x[3]);
    const double t13_6 = a[13]*(2*x[13]);
    const double t13_7 = a[17]*(1*x[10]);
    const double t13_8 = a[20]*(1*x[0]);
    const double t13_9 = a[23]*(1*x[6] + 1*x[4]);
    g[13] = t13_0 + t13_1 + t13_2 + t13_3 + t13_4 + t13_5 + t13_6 + t13_7 + t13_8 + t13_9;
    const double t14_0 = a[6]*(1*x[13] + 1*x[11] + 1*x[12] + 1*x[10]);
    const double t14_1 = a[7]*(1*x[3] + 1*x[4]);
    const double t14_2 = a[9]*(1*x[6] + 1*x[5]);
    const double t14_3 = a[21]*(1*x[0]);
    g[14] = t14_0 + t14_1 + t14_2 + t14_3;
    p[0] = x[13] + x[11] + x[10] + x[12];
    p[1] = x[6] + x[4] + x[5] + x[3];
    p[2] = x[0];
    p[3] = x[1]*x[13] + x[7]*x[11] + x[2]*x[11] + x[2]*x[10] + x[8]*x[10] + x[7]*x[13] + x[8]*x[12] + x[1]*x[12];
    p[4] = x[1]*x[11] + x[2]*x[13] + x[7]*x[12] + x[1]*x[10] + x[8]*x[11] + x[2]*x[12] + x[7]*x[10] + x[8]*x[13];
    p[5] = x[2]*x[6] + x[4]*x[8] + x[1]*x[5] + x[3]*x[7];
    p[6] = x[13]*x[14] + x[11]*x[14] + x[9]*x[12] + x[9]*x[11] + x[12]*x[14] + x[9]*x[10] + x[10]*x[14] + x[9]*x[13];
    p[7] = x[6]*x[9] + x[3]*x[14] + x[4]*x[14] + x[5]*x[9];
    p[8] = x[0]*x[4] + x[0]*x[5] + x[0]*x[3] + x[0]*x[6];
    p[9] = x[3]*x[9] + x[6]*x[14] + x[4]*x[9] + x[5]*x[14];
    p[10] = x[12]*x[13] + x[10]*x[11] + x[11]*x[13] + x[10]*x[12];
    p[11] = x[0]*x[0];
    p[12] = x[5]*x[13] + x[4]*x[12] + x[3]*x[11] + x[6]*x[11] + x[5]*x[12] + x[3]*x[13] + x[4]*x[10] + x[6]*x[10];
    p[13] = x[11]*x[11] + x[13]*x[13] + x[12]*x[12] + x[10]*x[10];
    p[14] = x[0]*x[7] + x[0]*x[2] + x[0]*x[1] + x[0]*x[8];
    p[15] = x[5]*x[5] + x[6]*x[6] + x[3]*x[3] + x[4]*x[4];
    p[16] = x[3]*x[8] + x[2]*x[5] + x[1]*x[6] + x[4]*x[7];
    p[17] = x[11]*x[12] + x[10]*x[13];
    p[18] = x[1]*x[3] + x[5]*x[8] + x[5]*x[7] + x[2]*x[3] + x[6]*x[7] + x[6]*x[8] + x[2]*x[4] + x[1]*x[4];
    p[19] = x[3]*x[4] + x[5]*x[6];
    p[20] = x[0]*x[12] + x[0]*x[11] + x[0]*x[10] + x[0]*x[13];
    p[21] = x[0]*x[14] + x[0]*x[9];
    p[22] = x[4]*x[5] + x[3]*x[5] + x[3]*x[6] + x[4]*x[6];
    p[23] = x[3]*x[12] + x[4]*x[11] + x[5]*x[11] + x[6]*x[12] + x[6]*x[13] + x[5]*x[10] + x[4]*x[13] + x[3]*x[10];

    double energy(0);
    for(int i = 0; i < 24; ++i)
        energy += p[i]*a[i];

    return energy;

}
} // namespace mb_system